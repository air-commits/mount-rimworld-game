# 图形界面使用指南

## 概述

游戏现在支持完整的图形界面（使用pygame），提供更好的视觉体验和交互方式。

## 安装

确保已安装pygame：

```bash
pip install pygame
```

或安装所有依赖：

```bash
pip install -r requirements.txt
```

## 启动图形界面

```bash
python game_gui.py
```

## 操作说明

### 基本控制

- **WASD 或 方向键**: 移动玩家角色
- **鼠标左键点击NPC**: 与NPC对话
- **ESC**: 关闭菜单/返回世界视图

### 快捷键

- **[M]**: 打开/关闭游戏菜单
- **[I]**: 打开/关闭背包界面
- **[Q]**: 打开/关闭任务列表
- **[C]**: 打开/关闭基地管理界面

### 游戏视图

游戏支持多种视图模式：

1. **世界视图**: 主要游戏视图，显示世界地图和所有实体
2. **菜单视图**: 游戏菜单
3. **对话视图**: 与NPC对话
4. **任务视图**: 查看和管理任务
5. **基地视图**: 管理资源和建筑

### 与世界交互

#### 移动
使用WASD或方向键在世界中移动。玩家角色会实时移动。

#### 与NPC对话
1. 在世界视图中，用鼠标点击NPC
2. 对话界面会自动打开
3. 输入消息后按回车发送
4. NPC会使用AI回复（如果启用了OpenAI）

#### 查看信息
- 顶部HUD显示玩家状态（姓名、等级、生命值、金币、位置）
- 底部显示快捷键提示

### 菜单系统

按 [M] 打开菜单，可以使用方向键选择，回车确认：

- **继续游戏**: 返回世界视图
- **查看状态**: 查看玩家详细信息
- **保存游戏**: 保存游戏进度（开发中）
- **退出游戏**: 退出游戏

### 任务系统

按 [Q] 查看任务列表，显示：
- 进行中的任务
- 任务进度
- 任务描述

### 基地管理

按 [C] 打开基地管理界面，显示：
- 当前资源数量
- 建筑状态（开发中）

## 图形界面特性

### 世界渲染

- **地形系统**: 不同颜色的地形（草地、森林、水域、山地等）
- **实体显示**: 
  - 玩家：蓝色圆点
  - NPC：绿色圆点
  - 显示实体名称

### 相机系统

- 相机自动跟随玩家
- 平滑的视角移动

### HUD显示

- 玩家信息栏（顶部）
- 快捷键提示（底部）
- 实时更新

### UI元素

- 半透明菜单背景
- 清晰的文本显示
- 响应式布局

## 技术细节

### 坐标系

游戏使用世界坐标和屏幕坐标的转换：

- **世界坐标**: 游戏世界的绝对坐标
- **屏幕坐标**: 窗口中的像素坐标

相机系统会自动处理坐标转换。

### 渲染循环

游戏以60 FPS运行，每帧：
1. 处理输入
2. 更新游戏逻辑
3. 渲染画面

### 性能优化

- 只渲染可见区域的瓦片和实体
- 限制FPS避免过度消耗资源

## 故障排除

### 窗口无法打开

- 确保已安装pygame: `pip install pygame`
- 检查Python版本（需要3.8+）
- 查看控制台错误信息

### 游戏运行缓慢

- 降低窗口分辨率
- 关闭其他占用资源的程序
- 检查显卡驱动

### 按键无响应

- 确保游戏窗口处于焦点状态
- 检查输入法（中文输入法可能干扰）

## 与命令行版本的区别

| 特性 | 图形界面版 | 命令行版 |
|------|-----------|---------|
| 视觉体验 | ✅ 图形化 | ❌ 纯文本 |
| 移动控制 | WASD/方向键 | 菜单选择 |
| NPC交互 | 点击对话 | 菜单选择 |
| 世界视图 | ✅ 可视化 | ❌ 文本描述 |
| 实时更新 | ✅ | ✅ |

## 未来改进

计划中的图形界面改进：

- [ ] 更精美的地图渲染
- [ ] 动画效果
- [ ] 更多UI元素
- [ ] 小地图
- [ ] 装备界面
- [ ] 战斗动画

## 开发提示

如果你想修改图形界面：

1. **修改颜色**: 编辑 `ui/game_window.py` 中的 `colors` 字典
2. **修改字体**: 修改 `font_small`, `font_medium`, `font_large`
3. **添加新视图**: 在 `GameView` 枚举中添加新类型，在 `render()` 中处理
4. **添加新快捷键**: 在 `handle_keydown()` 中添加处理逻辑

享受图形界面游戏！


